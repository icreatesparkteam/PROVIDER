<!DOCTYPE html>
<html>
<head>

<link rel="stylesheet" type="text/css" media="screen"
	href="css/form.css" />
<script type="text/javascript" src="js/config.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<title></title>
</head>
<body>
	<!-- 	<form action="" id="loginForm" method="post"
		onsubmit="return ValidateForm(this);">-->

	<form action="" id="loginForm" method="post">

		<script type="text/javascript">
			function loginfunction() {
				var form = document.getElementById("loginForm");

				var username = document.getElementById("UserName").value;
				var password = document.getElementById("Password").value;

				if (username === "" && password === "") {
					alert('Please enter your credentials');
				} else if (username === "") {
					alert('User Name is required.');
					form.UserName.focus();
				} else if (password === "") {
					alert('Password is required.');
					form.Password.focus();
				} else {
					$.ajax({
						type : "POST",
						url : config.Server_IP + config.splogin,
						data : {
							'username' : username,
							'password' : password
						},
						contentType : "application/x-www-form-urlencoded",

						success : function(data) {																						
							document.cookie = "lnt_access_token" + "=" + JSON.parse(JSON.stringify(data));
							window.sessionStorage.setItem("token",JSON.parse(JSON.stringify(data)));
							getRole();							
						},
						error : function() {
							alert('Invalid Credentials');
							//form.UserName.focus();
							return false;
						}
					});
				}
			}
			
			function getRole(){				
				var token = window.sessionStorage.getItem("token");	
				$.ajax({
				type : "GET",
				url : config.Server_IP + config.getrole,				
					headers: {
			             'lnt_access_token': token
			         },	
			        contentType : 'application/json',
					accepts : "text/plain",
					success : function(data) {
				//		alert("data:::"+data);
						if(data==="serviceprovider"){
							window.location = "/iControlE-ServiceProvider/html/spMainPage.html";	
						}
						else if(data==="user"){
							window.location = "/iControlE-ServiceProvider/html/userMainPage.html";	
						}					
						
					},
					error : function() {								
						
					}
				});
			}

		</script>
		<table border="0" cellpadding="5" cellspacing="0" width="600"
			class="login">
			<tr>
				<td><b>User Name:</b></td>
				<td><input id="UserName" name="UserName" type="text"
					class="loginFileds" /></td>
			</tr>
			<tr>
				<td><b>Password:</b></td>
				<td><input id="Password" name="Password" type="password"
					class="loginFileds" /></td>
			</tr>

			<tr>

				<td colspan="2" align="center"><input type="button"
					id="loginButton" name="Submit" onclick=loginfunction()
					value="LOG IN" /></td>
			</tr>
		</table>
		<br />
	</form>

</body>
</html>